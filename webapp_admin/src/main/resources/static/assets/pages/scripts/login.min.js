var Login=function(){var handleLogin=function(){$(".login-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:false,rules:{username:{required:true},password:{required:true},remember:{required:false}},messages:{username:{required:"[用户名]是必须输入项。"},password:{required:"[密码]是必须输入项。"}},invalidHandler:function(event,validator){$(".alert-danger",$(".login-form")).show()},highlight:function(element){$(element).closest(".form-group").addClass("has-error")},success:function(label){label.closest(".form-group").removeClass("has-error");label.remove()},errorPlacement:function(error,element){error.insertAfter(element.closest(".input-icon"))},submitHandler:function(form){form.submit()}});$(".login-form input").keypress(function(e){if(e.which==13){if($(".login-form").validate().form()){$(".login-form").submit()}return false}})};var handleForgetPassword=function(){$(".forget-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:false,ignore:"",rules:{email:{required:true,email:true}},messages:{email:{required:"Email 是必须输入项。"}},invalidHandler:function(event,validator){},highlight:function(element){$(element).closest(".form-group").addClass("has-error")},success:function(label){label.closest(".form-group").removeClass("has-error");label.remove()},errorPlacement:function(error,element){error.insertAfter(element.closest(".input-icon"))},submitHandler:function(form){form.submit()}});$(".forget-form input").keypress(function(e){if(e.which==13){if($(".forget-form").validate().form()){$(".forget-form").submit()}return false}});jQuery("#forget-password").click(function(){jQuery(".login-form").hide();jQuery(".forget-form").show()});jQuery("#back-btn").click(function(){jQuery(".login-form").show();jQuery(".forget-form").hide()})};var handleRegister=function(){function format(state){if(!state.id){return state.text}var $state=$('<span><img src="../assets/global/img/flags/'+state.element.value.toLowerCase()+'.png" class="img-flag" /> '+state.text+"</span>");return $state}if(jQuery().select2&&$("#country_list").size()>0){$("#country_list").select2({placeholder:'<i class="fa fa-map-marker"></i>&nbsp;Select a Country',templateResult:format,templateSelection:format,width:"auto",escapeMarkup:function(m){return m}});$("#country_list").change(function(){$(".register-form").validate().element($(this))})}$(".register-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:false,ignore:"",rules:{nickname:{required:true},username:{required:true},password:{required:true},rpassword:{equalTo:"#register_password"},tnc:{required:true}},messages:{nickname:{required:"[昵称]是必须输入项。"},username:{required:"[用户名]是必须输入项。"},password:{required:"[密码]是必须输入项。"},rpassword:{equalTo:"请再次输入相同的密码。"},tnc:{required:"请先接受注册协议。"}},invalidHandler:function(event,validator){},highlight:function(element){$(element).closest(".form-group").addClass("has-error")},success:function(label){label.closest(".form-group").removeClass("has-error");label.remove()},errorPlacement:function(error,element){if(element.attr("name")=="tnc"){error.insertAfter($("#register_tnc_error"))}else{if(element.closest(".input-icon").size()===1){error.insertAfter(element.closest(".input-icon"))}else{error.insertAfter(element)}}},submitHandler:function(form){form[0].submit()}});$(".register-form input").keypress(function(e){if(e.which==13){if($(".register-form").validate().form()){$(".register-form").submit()}return false}});jQuery("#register-btn").click(function(){jQuery(".login-form").hide();jQuery(".register-form").show()});jQuery("#register-back-btn").click(function(){jQuery(".login-form").show();jQuery(".register-form").hide()})};return{init:function(){handleLogin();handleForgetPassword();handleRegister()}}}();jQuery(document).ready(function(){Login.init()});